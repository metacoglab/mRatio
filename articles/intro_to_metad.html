<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fitting the meta-d' model • mRatio</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting the meta-d' model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mRatio</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/intro_to_metad.html">Fitting the meta-d' model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fitting the meta-d' model</h1>
            
      

      <div class="d-none name"><code>intro_to_metad.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to use the <code>mRatio</code> package
to fit the meta-d’ model (Maniscalco &amp; Lau, 2012) to a dataset
including a binary decision with confidence ratings.</p>
</div>
<div class="section level2">
<h2 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>To get a better idea of what kind of datasets the <code>mRatio</code>
package is designed for, we can start by simulating one (see
<code><a href="../reference/sim_metad.html">help('sim_metad')</a></code> for a description of the data simulation
function):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/" class="external-link">tidybayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://metacoglab.github.io/mRatio/">mRatio</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_metad.html">sim_metad</a></span><span class="op">(</span></span>
<span>  N_trials <span class="op">=</span> <span class="fl">1000</span>, dprime <span class="op">=</span> <span class="fl">.75</span>, c <span class="op">=</span> <span class="op">-</span><span class="fl">.5</span>, log_M <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  c2_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.75</span>, <span class="fl">1</span><span class="op">)</span>, c2_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span>, <span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   stimulus, response, confidence [16]</span></span></span>
<span><span class="co">#&gt;    trial stimulus response confidence</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10        0        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre>
<p>As you can see, our dataset has a column for the <code>trial</code>
number, the presented <code>stimulus</code> on each trial
(<code>0</code> or <code>1</code>), the participant’s type 1 response
(<code>0</code> or <code>1</code>), and the corresponding type 2
response (confidence; <code>1:K</code>). The trials in this dataset are
sorted by <code>stimulus</code>, <code>response</code>, and
<code>confidence</code> because this dataset is simulated, but otherwise
this should look very similar to the kind of data that you would
immediately get from running an experiment.</p>
<div class="section level3">
<h3 id="type-1-type-2-and-joint-responses">Type 1, type 2, and joint responses<a class="anchor" aria-label="anchor" href="#type-1-type-2-and-joint-responses"></a>
</h3>
<p>One hiccup is that some paradigms do not collect a separate decision
(i.e., type 1 response) and confidence rating (i.e., type 2
response)—rather, they collect a single rating reflecting both the
primary decision and confidence. For example, instead of a binary type 1
response and a type 2 response ranging from <code>1</code> to
<code>K</code> (where <code>K</code> is the maximum confidence level),
sometimes participants are asked to make a rating on a scale from
<code>1</code> to <code>2*K</code>, where <code>1</code> represents a
confidence <code>"0"</code> response, <code>K</code> represents an
uncertain <code>"0"</code> response, <code>K+1</code> represents an
uncertain <code>"1"</code> response, and <code>2*K</code> represents a
confident <code>"1"</code> response. We will refer to this as a
<em>joint response</em>, as it is a combination of the type 1 response
and the type 2 response.</p>
<p>If you would like to convert the joint response into separate type 1
and type 2 responses, you can use the corresponding functions
<code>type1_response</code> and <code>type2_response</code>. For
example, if instead we had a dataset that looked like this:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 2</span></span></span>
<span><span class="co">#&gt;    trial joint_response</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10              4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre>
<p>Then we could convert our joint response like so:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d.joint_response</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>response<span class="op">=</span><span class="fu"><a href="../reference/responses.html">type1_response</a></span><span class="op">(</span><span class="va">joint_response</span>, K<span class="op">=</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>         confidence<span class="op">=</span><span class="fu"><a href="../reference/responses.html">type2_response</a></span><span class="op">(</span><span class="va">joint_response</span>, K<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 4</span></span></span>
<span><span class="co">#&gt;    trial joint_response response confidence</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10              4        0          1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre></div>
<p>Similarly, you can also convert the separate responses into a joint
response:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>joint_response<span class="op">=</span><span class="fu"><a href="../reference/responses.html">joint_response</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">confidence</span>, K<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   stimulus, response, confidence [16]</span></span></span>
<span><span class="co">#&gt;    trial stimulus response confidence joint_response</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10        0        0          1              4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre></div>
<p>Note that in both cases we need to specify that our confidence scale
has <code>K=4</code> levels (meaning that our joint type 1/type 2 scale
has <code>8</code> levels).</p>
</div>
<div class="section level3">
<h3 id="signed-and-unsigned-binary-numbers">Signed and unsigned binary numbers<a class="anchor" aria-label="anchor" href="#signed-and-unsigned-binary-numbers"></a>
</h3>
<p>Often datasets will use <code>-1</code> and <code>1</code> instead of
<code>0</code> and <code>1</code> to represent the two possible stimuli
and type 1 responses. While the <code>mRatio</code> package is designed
to use the <em>unsigned</em> (<code>0</code> or <code>1</code>) version,
it provides helper functions to convert between the two:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/signed.html">to_unsigned</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0 1</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/signed.html">to_signed</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1  1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-aggregation">Data aggregation<a class="anchor" aria-label="anchor" href="#data-aggregation"></a>
</h3>
<p>Finally, to ensure that the model runs efficiently, the
<code>mRatio</code> package currently requires data to be aggregated. If
it is easier, the <code>mRatio</code> package will aggregate your data
for you when you fit your model. But if you would like to do so manually
(e.g., for plotting or follow-up analyses), the
<code>aggregate_metad</code> function can do this for you:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d.summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_metad.html">aggregate_metad</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;     N_0   N_1 N[,"N_0_1"] [,"N_0_2"] [,"N_0_3"] [,"N_0_4"] [,"N_0_5"] [,"N_0_6"]</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   500   500           3         59        117         44         83        135</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: N[7:16] &lt;int&gt;</span></span></span></code></pre>
<p>The resulting dataframe has three columns: <code>N_0</code> is the
number of trials with <code>stimulus==0</code>, <code>N_1</code> is the
number of trials with <code>stimulus==1</code>, and <code>N</code> is a
matrix containing the number of joint responses for each of the two
possible stimuli (with column names indicating the <code>stimulus</code>
and <code>joint_response</code>).</p>
<p>If you would like to use variable name other than <code>N</code> for
the counts, you can change the name with the <code>.response</code>
argument:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/aggregate_metad.html">aggregate_metad</a></span><span class="op">(</span><span class="va">d</span>, .response<span class="op">=</span><span class="st">'y'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;     y_0   y_1 y[,"y_0_1"] [,"y_0_2"] [,"y_0_3"] [,"y_0_4"] [,"y_0_5"] [,"y_0_6"]</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   500   500           3         59        117         44         83        135</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: y[7:16] &lt;int&gt;</span></span></span></code></pre></div>
<p>Finally, if you have other columns in your dataset (e.g.,
<code>participant</code> or <code>condition</code> columns) that you
would like to be aggregated separately, you can simply add them to the
function call:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">aggregate_metad</span>(d, participant condition)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<p>To fit the model, we can use the <code>fit_metad</code> function.
This function is simply a wrapper around <code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brms::brm</a></code>, so
users are <strong>strongly</strong> encouraged to become familiar with
<code>brms</code> before model fitting.</p>
<p>Since <code>aggregate_metad</code> will place our dataset has our
trial counts into a column named <code>N</code> by default, we can use
<code>N</code> as our response variable even if our data is not yet
aggregated. To fit a model with fixed values for each parameter, then,
we can use the formula <code>N ~ 1</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_metad.html">fit_metad</a></span><span class="op">(</span><span class="va">N</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">d</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"models/metad.rds"</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">dprime</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">c</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">metac2zero1diff</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">metac2zero2diff</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">metac2one1diff</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">lognormal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">metac2one2diff</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Running /opt/R/4.5.2/lib/R/bin/R CMD SHLIB foo.c</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; gcc -std=gnu2x -I"/opt/R/4.5.2/lib/R/include" -DNDEBUG   -I"/home/runner/work/_temp/Library/Rcpp/include/"  -I"/home/runner/work/_temp/Library/RcppEigen/include/"  -I"/home/runner/work/_temp/Library/RcppEigen/include/unsupported"  -I"/home/runner/work/_temp/Library/BH/include" -I"/home/runner/work/_temp/Library/StanHeaders/include/src/"  -I"/home/runner/work/_temp/Library/StanHeaders/include/"  -I"/home/runner/work/_temp/Library/RcppParallel/include/"  -I"/home/runner/work/_temp/Library/rstan/include" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include '/home/runner/work/_temp/Library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include    -fpic  -g -O2  -c foo.c -o foo.o</span></span>
<span><span class="co">#&gt; In file included from /home/runner/work/_temp/Library/RcppEigen/include/Eigen/Core:19,</span></span>
<span><span class="co">#&gt;                  from /home/runner/work/_temp/Library/RcppEigen/include/Eigen/Dense:1,</span></span>
<span><span class="co">#&gt;                  from /home/runner/work/_temp/Library/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22,</span></span>
<span><span class="co">#&gt;                  from &lt;command-line&gt;:</span></span>
<span><span class="co">#&gt; /home/runner/work/_temp/Library/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: cmath: No such file or directory</span></span>
<span><span class="co">#&gt;   679 | #include &lt;cmath&gt;</span></span>
<span><span class="co">#&gt;       |          ^~~~~~~</span></span>
<span><span class="co">#&gt; compilation terminated.</span></span>
<span><span class="co">#&gt; make: *** [/opt/R/4.5.2/lib/R/etc/Makeconf:202: foo.o] Error 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: Rejecting initial value:</span></span>
<span><span class="co">#&gt; Chain 1:   Gradient evaluated at the initial value is not finite.</span></span>
<span><span class="co">#&gt; Chain 1:   Stan can't start sampling from this initial value.</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 1.1e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 0.081 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.065 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                0.146 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).</span></span>
<span><span class="co">#&gt; Chain 2: Rejecting initial value:</span></span>
<span><span class="co">#&gt; Chain 2:   Gradient evaluated at the initial value is not finite.</span></span>
<span><span class="co">#&gt; Chain 2:   Stan can't start sampling from this initial value.</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Gradient evaluation took 9e-06 seconds</span></span>
<span><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.09 seconds.</span></span>
<span><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2:  Elapsed Time: 0.083 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 2:                0.067 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2:                0.15 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: Gradient evaluation took 1.4e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.14 seconds.</span></span>
<span><span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3:  Elapsed Time: 0.082 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 3:                0.066 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3:                0.148 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).</span></span>
<span><span class="co">#&gt; Chain 4: Rejecting initial value:</span></span>
<span><span class="co">#&gt; Chain 4:   Gradient evaluated at the initial value is not finite.</span></span>
<span><span class="co">#&gt; Chain 4:   Stan can't start sampling from this initial value.</span></span>
<span><span class="co">#&gt; Chain 4: </span></span>
<span><span class="co">#&gt; Chain 4: Gradient evaluation took 9e-06 seconds</span></span>
<span><span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.09 seconds.</span></span>
<span><span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 4: </span></span>
<span><span class="co">#&gt; Chain 4: </span></span>
<span><span class="co">#&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4: </span></span>
<span><span class="co">#&gt; Chain 4:  Elapsed Time: 0.088 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 4:                0.066 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 4:                0.154 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 4:</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  Family: metad__4__normal__absolute </span></span>
<span><span class="co">#&gt;   Links: mu = log </span></span>
<span><span class="co">#&gt; Formula: N ~ 1 </span></span>
<span><span class="co">#&gt;    Data: data.aggregated (Number of observations: 1) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept    -0.69      0.32    -1.43    -0.15 1.00     4865     3047</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; dprime              0.71      0.08     0.54     0.87 1.00     6299     2751</span></span>
<span><span class="co">#&gt; c                  -0.49      0.04    -0.57    -0.41 1.00     4208     2761</span></span>
<span><span class="co">#&gt; metac2zero1diff     0.21      0.02     0.17     0.26 1.00     6164     2998</span></span>
<span><span class="co">#&gt; metac2zero2diff     0.78      0.05     0.68     0.89 1.00     5144     2949</span></span>
<span><span class="co">#&gt; metac2zero3diff     1.27      0.17     0.97     1.63 1.00     5911     3002</span></span>
<span><span class="co">#&gt; metac2one1diff      0.47      0.03     0.41     0.54 1.00     5660     3143</span></span>
<span><span class="co">#&gt; metac2one2diff      1.00      0.05     0.91     1.09 1.00     5878     2975</span></span>
<span><span class="co">#&gt; metac2one3diff      1.30      0.11     1.10     1.52 1.00     8763     3453</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre>
<p>Note that here we have arbitrarily chosen to use standard normal
priors for all parameters. To get a better idea of how to set informed
priors, please refer to
<code><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">help('set_prior', package='brms')</a></code>.</p>
<p>In this model, <code>Intercept</code> is our estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">log</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">log</mtext><mfrac><mrow><mtext mathvariant="normal">meta-</mtext><mi>d</mi><mi>′</mi></mrow><mrow><mi>d</mi><mi>′</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\textrm{log}(M) = \textrm{log}\frac{\textrm{meta-}d'}{d'}</annotation></semantics></math>,
<code>dprime</code> is our estimate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">d'</annotation></semantics></math>,
<code>c</code> is our estimate of <code>c</code>,
<code>metac2zero1diff</code> and <code>metac2zero2diff</code> are the
distances between successive confidence thresholds for <code>"0"</code>
responses, and <code>metac2one1diff</code> and
<code>metac2one2diff</code> are the distances between successive
confidence thresholds for <code>"1"</code> responses. For each
parameter, <code>brms</code> shows you the posterior means
(<code>Estimate</code>), posterior standard deviations
(<code>Est. Error</code>), upper- and lower-95% posterior quantiles
(<code>l-95% CI</code> and <code>u-95% CI</code>), as well as some
convergence metrics (<code>Rhat</code>, <code>Bulk_ESS</code>, and
<code>Tail_ESS</code>).</p>
</div>
<div class="section level2">
<h2 id="extract-model-estimates">Extract model estimates<a class="anchor" aria-label="anchor" href="#extract-model-estimates"></a>
</h2>
<p>Once we have our fitted model, there are many estimates that we can
extract from it. Although <code>brms</code> provides its own functions
for extracting posterior estimates, the <code>mRatio</code> package is
designed to interface well with the <code>tidybayes</code> package to
make it easier to work with model posterior samples.</p>
<div class="section level3">
<h3 id="parameter-estimates">Parameter estimates<a class="anchor" aria-label="anchor" href="#parameter-estimates"></a>
</h3>
<p>First, it is often useful to extract the posterior draws of the model
parameters. Here we can use <code><a href="https://mjskay.github.io/tidybayes/reference/add_predicted_draws.html" class="external-link">tidybayes::linpred_draws</a></code> (with
arguments <code>dpar=TRUE</code> and <code>transform=TRUE</code> to
extract the estimates of all model parameters on their true scale):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws.linpred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.row <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/add_predicted_draws.html" class="external-link">add_linpred_draws</a></span><span class="op">(</span><span class="va">m</span>, dpar <span class="op">=</span> <span class="cn">TRUE</span>, transform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,000 × 14</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   .row [1]</span></span></span>
<span><span class="co">#&gt;     .row .chain .iteration .draw .linpred    mu dprime      c metac2zero1diff</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1    0.635 0.635  0.756 -<span style="color: #BB0000;">0.505</span>           0.201</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     2    0.419 0.419  0.723 -<span style="color: #BB0000;">0.503</span>           0.197</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     3    0.358 0.358  0.775 -<span style="color: #BB0000;">0.499</span>           0.212</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     4    0.571 0.571  0.687 -<span style="color: #BB0000;">0.463</span>           0.206</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     5    0.499 0.499  0.803 -<span style="color: #BB0000;">0.540</span>           0.243</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     6    0.398 0.398  0.735 -<span style="color: #BB0000;">0.557</span>           0.231</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     7    0.574 0.574  0.605 -<span style="color: #BB0000;">0.475</span>           0.197</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     8    0.456 0.456  0.716 -<span style="color: #BB0000;">0.501</span>           0.227</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     9    0.693 0.693  0.476 -<span style="color: #BB0000;">0.482</span>           0.190</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>    10    0.596 0.596  0.777 -<span style="color: #BB0000;">0.481</span>           0.239</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: metac2zero2diff &lt;dbl&gt;, metac2zero3diff &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   metac2one1diff &lt;dbl&gt;, metac2one2diff &lt;dbl&gt;, metac2one3diff &lt;dbl&gt;</span></span></span></code></pre>
<p>This <code>tibble</code> has a separate row for every posterior
sample and a separate column for every model parameter
(<code>.linpred</code> and <code>mu</code> both representing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mtext mathvariant="normal">-ratio</mtext></mrow><annotation encoding="application/x-tex">M\textrm{-ratio}</annotation></semantics></math>).
This format is useful for some purposes, but it will often be useful to
pivot it so that we have a separate row for each model parameter and
posterior sample:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws.linpred</span> <span class="op">&lt;-</span> <span class="va">draws.linpred</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">.linpred</span><span class="op">:</span><span class="va">metac2one3diff</span>, names_to <span class="op">=</span> <span class="st">".variable"</span>, values_to <span class="op">=</span> <span class="st">".value"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 40,000 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   .row [1]</span></span></span>
<span><span class="co">#&gt;     .row .chain .iteration .draw .variable       .value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 .linpred         0.635</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 mu               0.635</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 dprime           0.756</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 c               -<span style="color: #BB0000;">0.505</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 metac2zero1diff  0.201</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 metac2zero2diff  0.753</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 metac2zero3diff  1.57 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 metac2one1diff   0.485</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 metac2one2diff   1.03 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 metac2one3diff   1.26 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 39,990 more rows</span></span></span></code></pre>
<p>Now that all of the posterior samples are stored in a single column
<code>.value</code>, it is easy to get posterior summaries using
e.g. <code><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">tidybayes::median_qi</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws.linpred</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">.variable</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">.value</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 7</span></span></span>
<span><span class="co">#&gt;    .variable       .value .lower .upper .width .point .interval</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> .linpred         0.518  0.240  0.865   0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> c               -<span style="color: #BB0000;">0.493</span> -<span style="color: #BB0000;">0.574</span> -<span style="color: #BB0000;">0.409</span>   0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> dprime           0.707  0.543  0.871   0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> metac2one1diff   0.472  0.409  0.539   0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> metac2one2diff   0.999  0.910  1.09    0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> metac2one3diff   1.30   1.10   1.52    0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> metac2zero1diff  0.212  0.167  0.263   0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> metac2zero2diff  0.780  0.678  0.892   0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> metac2zero3diff  1.26   0.971  1.63    0.95 median qi       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> mu               0.518  0.240  0.865   0.95 median qi</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="posterior-predictions">Posterior predictions<a class="anchor" aria-label="anchor" href="#posterior-predictions"></a>
</h3>
<p>One way to evaluate model fit is to perform a <em>posterior
predictive check</em>: to simulate data from the model’s posterior and
compare our simulated and actual data. We can do this using
<code>tidybayes::posterior_predict</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws.predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/add_predicted_draws.html" class="external-link">predicted_draws</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">d.summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 64,000 × 9</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   N_0, N_1, N, .row, .category [16]</span></span></span>
<span><span class="co">#&gt;      N_0   N_1 N[,"N_0_1"]  .row .chain .iteration .draw .category .prediction</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 N_0_1               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     2 N_0_1               7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     3 N_0_1               2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     4 N_0_1               7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     5 N_0_1               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     6 N_0_1               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     7 N_0_1               2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     8 N_0_1               2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     9 N_0_1               8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>    10 N_0_1               6</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 63,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: N[2:16] &lt;int&gt;</span></span></span></code></pre>
<p>In this dataframe, we have all of the columns from our aggregated
data <code>d.summary</code> as well as <code>.category</code>
(indicating the simulated stimulus and joint response) and
<code>.prediction</code> (indicating the number of simulated trials per
stimulus and joint response). To make this format easier to manage, we
can pull the relevant information out of <code>.category</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws.predicted</span> <span class="op">&lt;-</span> <span class="va">draws.predicted</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">.category</span>,</span>
<span>    into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"var"</span>, <span class="st">"stimulus"</span>, <span class="st">"joint_response"</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"_"</span>, convert <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="../reference/responses.html">type1_response</a></span><span class="op">(</span><span class="va">joint_response</span>, K<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    confidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="../reference/responses.html">type2_response</a></span><span class="op">(</span><span class="va">joint_response</span>, K<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 64,000 × 13</span></span></span>
<span><span class="co">#&gt;      N_0   N_1 N[,"N_0_1"]  .row .chain .iteration .draw var   stimulus</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     2 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     3 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     4 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     5 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     6 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     7 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     8 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     9 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   500   500           3     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>    10 N            0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 63,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: N[2:16] &lt;int&gt;, joint_response &lt;int&gt;, .prediction &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   response &lt;fct&gt;, confidence &lt;fct&gt;</span></span></span></code></pre>
<p>We now have a tidy <code>tibble</code> with a row per
<code>stimulus</code>, <code>response</code>, and
<code>confidence</code>, with <code>.prediction</code> containing the
number of simulated trials. From here, we can plot the posterior
predictions (points and errorbars) against the actual data (bars):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws.predicted</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">.row</span>, <span class="va">stimulus</span>, <span class="va">joint_response</span>, <span class="va">response</span>, <span class="va">confidence</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">.prediction</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">.row</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">d.summary</span><span class="op">$</span><span class="va">N</span><span class="op">[</span><span class="va">.row</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">joint_response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">N</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">'grey80'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.prediction</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">stimulus</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in `[&lt;-.data.frame`(`*tmp*`, , y_vars, value = list(y = c(3, 59, :</span></span>
<span><span class="co">#&gt; replacement element 1 has 256 rows to replace 16 rows</span></span></code></pre></div>
<p><img src="intro_to_metad_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" alt="" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="posterior-expectations">Posterior expectations<a class="anchor" aria-label="anchor" href="#posterior-expectations"></a>
</h3>
<p>Usually it will be simpler to compare response probabilities rather
than raw response counts. To do this, we can use the same workflow as
above but using <code><a href="https://mjskay.github.io/tidybayes/reference/add_predicted_draws.html" class="external-link">tidybayes::epred_draws</a></code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws.epred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/add_predicted_draws.html" class="external-link">epred_draws</a></span><span class="op">(</span><span class="va">m</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.row <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">.category</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"var"</span>, <span class="st">"stimulus"</span>, <span class="st">"joint_response"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>, convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="../reference/responses.html">type1_response</a></span><span class="op">(</span><span class="va">joint_response</span>, K<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    confidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="../reference/responses.html">type2_response</a></span><span class="op">(</span><span class="va">joint_response</span>, K<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 64,000 × 10</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   .row [1]</span></span></span>
<span><span class="co">#&gt;     .row .chain .iteration .draw var   stimulus joint_response  .epred response</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     1 N            0              1 0.002<span style="text-decoration: underline;">96</span> 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     2 N            0              1 0.010<span style="text-decoration: underline;">0</span>  0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     3 N            0              1 0.003<span style="text-decoration: underline;">75</span> 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     4 N            0              1 0.012<span style="text-decoration: underline;">2</span>  0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     5 N            0              1 0.005<span style="text-decoration: underline;">35</span> 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     6 N            0              1 0.005<span style="text-decoration: underline;">04</span> 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     7 N            0              1 0.003<span style="text-decoration: underline;">63</span> 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     8 N            0              1 0.005<span style="text-decoration: underline;">09</span> 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>     9 N            0              1 0.008<span style="text-decoration: underline;">28</span> 0       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>    10 N            0              1 0.006<span style="text-decoration: underline;">37</span> 0       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 63,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: confidence &lt;fct&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws.epred</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">.row</span>, <span class="va">stimulus</span>, <span class="va">joint_response</span>, <span class="va">response</span>, <span class="va">confidence</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">.epred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">.row</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>.true<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="../reference/response_probabilities.html">response_probabilities</a></span><span class="op">(</span><span class="va">d.summary</span><span class="op">$</span><span class="va">N</span><span class="op">[</span><span class="va">.row</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">joint_response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.true</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">'grey80'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.epred</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha_discrete</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">stimulus</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using alpha for a discrete variable is not advised.</span></span>
<span><span class="co">#&gt; Warning in `[&lt;-.data.frame`(`*tmp*`, , y_vars, value = list(y = c(0.006, :</span></span>
<span><span class="co">#&gt; replacement element 1 has 256 rows to replace 16 rows</span></span></code></pre></div>
<p><img src="intro_to_metad_files/figure-html/epred-1.png" class="r-plt" alt="" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="mean-confidence">Mean confidence<a class="anchor" aria-label="anchor" href="#mean-confidence"></a>
</h3>
<p>One can also compute implied values of mean confidence from the
meta-d’ model using <code>mean_confidence_draws</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.row <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mean_conf_draws.html">add_mean_confidence_draws</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">.epred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">d</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">stimulus</span>, <span class="va">response</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>.true<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">confidence</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has regrouped the output.</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(stimulus, response)`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Summaries were computed grouped by <span style="color: #0000BB;">stimulus</span> and <span style="color: #0000BB;">response</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Output is grouped by <span style="color: #0000BB;">stimulus</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `summarise(.groups = "drop_last")` to silence this message.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `summarise(.by = c(stimulus, response))` for per-operation grouping</span></span>
<span><span class="co">#&gt;   (`?dplyr::dplyr_by`) instead.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 10</span></span></span>
<span><span class="co">#&gt;    .row stimulus response .epred .lower .upper .width .point .interval .true</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1        0        0   2.07   1.99   2.15   0.95 median qi         2.09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1        0        1   1.91   1.83   1.99   0.95 median qi         1.92</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1        1        0   1.95   1.86   2.04   0.95 median qi         1.90</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1        1        1   2.08   2.02   2.15   0.95 median qi         2.07</span></span></code></pre></div>
<p>Here, <code>.epred</code> refers to the model-estimated mean
confidence per stimulus and response, and <code>.true</code> is the
empirical mean confidence.</p>
<p>In addition, we can compute mean confidence marginalizing over
stimuli:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.row <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mean_conf_draws.html">add_mean_confidence_draws</a></span><span class="op">(</span><span class="va">m</span>, by_stimulus<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">.epred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">d</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>.true<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">confidence</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(response)`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">#&gt;    .row response .epred .lower .upper .width .point .interval .true</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1        0   2.03   1.95   2.11   0.95 median qi         2.03</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1        1   2.01   1.96   2.07   0.95 median qi         2.01</span></span></code></pre></div>
<p>over responses:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.row <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mean_conf_draws.html">add_mean_confidence_draws</a></span><span class="op">(</span><span class="va">m</span>, by_response<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">.epred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">d</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">stimulus</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>.true<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">confidence</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(stimulus)`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">#&gt;    .row stimulus .epred .lower .upper .width .point .interval .true</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1        0   1.98   1.93   2.03   0.95 median qi         2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1        1   2.06   2.01   2.11   0.95 median qi         2.04</span></span></code></pre></div>
<p>or both over stimuli and responses:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.row <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mean_conf_draws.html">add_mean_confidence_draws</a></span><span class="op">(</span><span class="va">m</span>, by_stimulus<span class="op">=</span><span class="cn">FALSE</span>, by_response<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">.epred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">d</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>.true<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">confidence</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 8</span></span></span>
<span><span class="co">#&gt;    .row .epred .lower .upper .width .point .interval .true</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1   2.02   1.97   2.06   0.95 median qi         2.02</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pseudo-type-1-roc">Pseudo Type 1 ROC<a class="anchor" aria-label="anchor" href="#pseudo-type-1-roc"></a>
</h3>
<p>To plot type 1 performance as a pseudo-type 1 ROC, we can use
<code>add_roc1_draws</code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.row <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/roc1_draws.html">add_roc1_draws</a></span><span class="op">(</span><span class="va">m</span>, bounds <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">p_fa</span>, <span class="va">p_hit</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">p_fa</span>, xmin <span class="op">=</span> <span class="va">p_fa.lower</span>, xmax <span class="op">=</span> <span class="va">p_fa.upper</span>,</span>
<span>    y <span class="op">=</span> <span class="va">p_hit</span>, ymin <span class="op">=</span> <span class="va">p_hit.lower</span>, ymax <span class="op">=</span> <span class="va">p_hit.upper</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"y"</span>, width <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"x"</span>, width <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, ylim <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"P(False Alarm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"P(Hit)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_to_metad_files/figure-html/roc1-1.png" class="r-plt" alt="" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="type-2-roc">Type 2 ROC<a class="anchor" aria-label="anchor" href="#type-2-roc"></a>
</h3>
<p>Finally, to plot type 2 performance as a type 2 ROC, we can use
<code>add_roc2_draws</code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>.row <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/roc2_draws.html">add_roc2_draws</a></span><span class="op">(</span><span class="va">m</span>, bounds <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">median_qi</a></span><span class="op">(</span><span class="va">p_hit2</span>, <span class="va">p_fa2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">p_fa2</span>, xmin <span class="op">=</span> <span class="va">p_fa2.lower</span>, xmax <span class="op">=</span> <span class="va">p_fa2.upper</span>,</span>
<span>    y <span class="op">=</span> <span class="va">p_hit2</span>, ymin <span class="op">=</span> <span class="va">p_hit2.lower</span>, ymax <span class="op">=</span> <span class="va">p_hit2.upper</span>,</span>
<span>    color <span class="op">=</span> <span class="va">response</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"y"</span>, width <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"x"</span>, width <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, ylim <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"P(Type 2 False Alarm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"P(Type 2 Hit)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_to_metad_files/figure-html/roc2-1.png" class="r-plt" alt="" width="75%" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin O’Neill.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
